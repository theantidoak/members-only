(()=>{"use strict";var e={188:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{d(r.next(e))}catch(e){i(e)}}function c(e){try{d(r.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,c)}d((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(356);function i(e){return r(this,void 0,void 0,(function*(){var t,n,r,o;const l=e.currentTarget;l.removeEventListener("click",i);const c=null===(r=null===(n=null===(t=l.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.parentElement,d=document.querySelector("main");null===(o=d.parentElement)||void 0===o||o.removeAttribute("style"),[...d.children].forEach(((e,t,n)=>{n.indexOf(e)!==n.length-1&&e.removeAttribute("style")})),c.remove()}))}function l(){return r(this,void 0,void 0,(function*(){var e;try{const t=document.querySelector("main"),n=yield fetch("/messages/create",{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}),r=yield n.text(),l=(0,o.convertToDomNode)(r),c=document.createElement("section");c.appendChild(l),t.appendChild(c),null===(e=t.parentElement)||void 0===e||e.setAttribute("style","overflow: hidden"),[...t.children].forEach(((e,t,n)=>{n.indexOf(e)!==n.length-1&&e.setAttribute("style","filter: blur(6px); pointer-events: none")})),l.querySelector("textarea").addEventListener("input",v);const d=l.querySelector(".form__cancel-btn");null==d||d.addEventListener("click",i)}catch(e){console.error("Error loading create message form: ",e)}}))}function c(e){return r(this,void 0,void 0,(function*(){var t;const n=e.currentTarget;try{const e=null===(t=n.parentElement)||void 0===t?void 0:t.parentElement,r=e.id.replace("id-",""),i=yield fetch(`/messages/update?id=${r}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}),l=yield i.text(),s=(0,o.convertToDomNode)(l),a=document.createElement("li");a.setAttribute("data-id",r),a.classList.add("messages__item"),a.appendChild(s),n.removeEventListener("click",c),e.replaceWith(a);const u=s.querySelector(".form__cancel-btn");null==u||u.addEventListener("click",d)}catch(e){console.error("Error loading update message form: ",e)}}))}function d(e){return r(this,void 0,void 0,(function*(){var t,n,r;const i=e.currentTarget,l=null===(r=null===(n=null===(t=i.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement)||void 0===r?void 0:r.parentElement;try{const e=yield fetch(`/messages/message?id=${l.dataset.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}),t=yield e.text(),n=(0,o.convertToDomNode)(t);i.removeEventListener("click",d),l.replaceWith(n);const r=document.querySelector(".messages__delete-btn");r.prop={btn:r,error:void 0},null==r||r.addEventListener("click",u);const s=n.querySelector(".messages__edit-btn");null==s||s.addEventListener("click",c)}catch(e){console.error("Error loading update message form: ",e)}}))}function s(e){return r(this,void 0,void 0,(function*(){var t,n,r;const o=e.currentTarget;o.removeEventListener("click",i);const l=null===(n=null===(t=o.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement,c=document.querySelector("main");null===(r=c.parentElement)||void 0===r||r.removeAttribute("style"),[...c.children].forEach(((e,t,n)=>{n.indexOf(e)!==n.length-1&&e.removeAttribute("style")})),l.remove()}))}function a(e){return r(this,void 0,void 0,(function*(){var t,n,r;const o=e.currentTarget,i=null===(n=null===(t=o.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement,l=i.dataset.id,c=JSON.stringify({id:l}),d=document.querySelector("main");null===(r=d.parentElement)||void 0===r||r.removeAttribute("style"),[...d.children].forEach(((e,t,n)=>{n.indexOf(e)!==n.length-1&&e.removeAttribute("style")}));try{const e=yield fetch("/messages/delete",{method:"POST",body:c,headers:{Accept:"application/json","Content-Type":"application/json"}}),t=yield e.json(),n=document.querySelector(`li#id-${l}`),r={btn:n.querySelector(".messages__delete-btn"),error:t.message};t.success?n.remove():u.call({prop:r})}catch(e){console.error("Error deleting message.",e)}i.remove(),o.removeEventListener("click",a)}))}function u(){return r(this,void 0,void 0,(function*(){var e,t;const{btn:n,error:r}=this.prop;try{const i=document.querySelector("main"),l=(null===(e=n.parentElement)||void 0===e?void 0:e.parentElement).id.replace("id-",""),c=yield fetch(`/messages/delete?error=${r}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}),d=yield c.text(),v=(0,o.convertToDomNode)(d);v.setAttribute("data-id",l),i.appendChild(v),null===(t=i.parentElement)||void 0===t||t.setAttribute("style","overflow: hidden"),[...i.children].forEach(((e,t,n)=>{n.indexOf(e)!==n.length-1&&e.setAttribute("style","filter: blur(6px); pointer-events: none")}));const m=v.querySelector(".form__cancel-verify-btn");null==m||m.addEventListener("click",s);const p=v.querySelector(".form__delete-verify-btn");null==p||p.addEventListener("click",(e=>{a(e),n.removeEventListener("click",u)}))}catch(r){console.error("Error loading delete message.",r)}}))}function v(e){const t=e.currentTarget;t.nextElementSibling.textContent=`${t.value.length} / 500 Characters`}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".messages__create-btn");null==e||e.addEventListener("click",l),[...document.querySelectorAll(".messages__edit-btn")].forEach((e=>{e.addEventListener("click",c)})),[...document.querySelectorAll(".messages__delete-btn")].forEach((e=>{e.prop={btn:e,error:void 0},e.addEventListener("click",u)}))}))},356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertToDomNode=void 0,t.convertToDomNode=function(e){return(new DOMParser).parseFromString(e,"text/html").body.firstChild}}},t={};!function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(188)})();